## GPT4-Rec实施过程

### 1. 兴趣查询生成

系统首先基于用户历史购买记录构建结构化 Prompt，格式如下：

> *Previously, the customer has bought:*
>  *<ITEM TITLE 1>. <ITEM TITLE 2>...*
>  *In the future, the customer wants to buy*

该 Prompt 将物品标题作为语义输入，引导模型理解用户偏好。使用推荐数据集对 **GPT-2** 进行微调后，模型能够学习到用户的潜在兴趣表征，并在推理阶段以该 Prompt 为条件，通过 **Beam Search** 技术生成多个多样化的候选查询，用以覆盖用户兴趣的不同方面与粒度。

------

### 2. 物品检索与推荐

将上一阶段生成的多个查询分别输入至一个外部搜索引擎（如 BM25），在全量物品库中检索与每个查询最相关的物品列表。

为融合多查询结果，采用**排序融合策略**：优先从生成得分最高的查询返回结果中选取物品，随后依次从其余查询的结果中补充不重复项，直至形成最终的 Top-K 推荐列表。该策略有效兼顾了推荐的相关性与多样性。



